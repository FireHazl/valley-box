<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Obsessive Valley Box</title>
  <style>
    :root {
      --bg: #05070a;
      --face-main: #0b1020;
      --face-accent: #151c30;
      --pixel-light: rgba(216, 240, 255, 0.9);
      --pixel-mid: rgba(74, 107, 136, 0.8);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html,
    body {
      width: 100%;
      height: 100%;
      background: var(--bg);
      color: #e8edf5;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      overflow: hidden;
    }

    #valley-root {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 0.75rem;
    }

    .label {
      font-size: 0.8rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      opacity: 0.7;
    }

    .scene {
      width: 220px;
      height: 220px;
      position: relative;
      perspective: 800px;
      filter: drop-shadow(0 0 18px rgba(0, 0, 0, 0.8));
    }

    .cube {
      width: 140px;
      height: 140px;
      position: absolute;
      top: 50%;
      left: 50%;
      transform-style: preserve-3d;
      transform: translate(-50%, -50%) rotateX(-22deg) rotateY(30deg);
      animation: auto-spin 12s linear infinite;
      cursor: grab;
    }

    .cube.dragging {
      animation-play-state: paused;
      cursor: grabbing;
    }

    .face {
      position: absolute;
      width: 140px;
      height: 140px;
      background-color: var(--face-main);
      border: 2px solid rgba(120, 144, 184, 0.4);
      box-shadow:
        inset 0 0 0 1px rgba(10, 16, 32, 0.9),
        0 0 0 1px rgba(8, 10, 18, 0.9);
      background-image:
        repeating-linear-gradient(
          45deg,
          rgba(12, 20, 44, 0.9) 0,
          rgba(12, 20, 44, 0.9) 2px,
          rgba(5, 8, 20, 0.95) 2px,
          rgba(5, 8, 20, 0.95) 4px
        );
      image-rendering: pixelated;
    }

    /* Псевдопиксели */
    .face::before,
    .face::after {
      content: "";
      position: absolute;
      inset: 0;
      background-image:
        radial-gradient(
          circle at 10% 20%,
          var(--pixel-light) 0,
          transparent 35%
        ),
        radial-gradient(
          circle at 70% 30%,
          var(--pixel-mid) 0,
          transparent 40%
        ),
        radial-gradient(
          circle at 30% 80%,
          rgba(150, 190, 230, 0.8) 0,
          transparent 35%
        );
      background-size: 12px 12px, 16px 16px, 20px 20px;
      mix-blend-mode: screen;
      opacity: 0.55;
      image-rendering: pixelated;
    }

    .face::after {
      mix-blend-mode: soft-light;
      opacity: 0.45;
      filter: blur(0.2px);
    }

    .face-top,
    .face-bottom {
      background-color: var(--face-accent);
    }

    .face-front {
      transform: translateZ(70px);
    }

    .face-back {
      transform: rotateY(180deg) translateZ(70px);
    }

    .face-right {
      transform: rotateY(90deg) translateZ(70px);
    }

    .face-left {
      transform: rotateY(-90deg) translateZ(70px);
    }

    .face-top {
      transform: rotateX(90deg) translateZ(70px);
    }

    .face-bottom {
      transform: rotateX(-90deg) translateZ(70px);
    }

    .hint {
      font-size: 0.75rem;
      opacity: 0.6;
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }

    @keyframes auto-spin {
      0% {
        transform: translate(-50%, -50%) rotateX(-22deg) rotateY(0deg);
      }
      50% {
        transform: translate(-50%, -50%) rotateX(-10deg) rotateY(180deg);
      }
      100% {
        transform: translate(-50%, -50%) rotateX(-22deg) rotateY(360deg);
      }
    }
  </style>
</head>
<body>
  <div id="valley-root">
    <div class="label">Obsessive Valley // Box</div>

    <div class="scene">
      <div class="cube" id="valley-cube">
        <div class="face face-front"></div>
        <div class="face face-back"></div>
        <div class="face face-right"></div>
        <div class="face face-left"></div>
        <div class="face face-top"></div>
        <div class="face face-bottom"></div>
      </div>
    </div>

    <div class="hint">Click & drag to rotate</div>
  </div>

  <script>
    (function () {
      const cube = document.getElementById("valley-cube");

      if (!cube) return;

      let isDragging = false;
      let previous = { x: 0, y: 0 };
      let rotation = { x: -22, y: 30 };

      function setTransform() {
        cube.style.transform =
          "translate(-50%, -50%) rotateX(" +
          rotation.x +
          "deg) rotateY(" +
          rotation.y +
          "deg)";
      }

      function onPointerDown(e) {
        isDragging = true;
        cube.classList.add("dragging");
        previous.x = e.clientX ?? e.touches?.[0]?.clientX ?? 0;
        previous.y = e.clientY ?? e.touches?.[0]?.clientY ?? 0;
      }

      function onPointerMove(e) {
        if (!isDragging) return;

        const clientX = e.clientX ?? e.touches?.[0]?.clientX ?? previous.x;
        const clientY = e.clientY ?? e.touches?.[0]?.clientY ?? previous.y;

        const deltaX = clientX - previous.x;
        const deltaY = clientY - previous.y;

        const speed = 0.4;

        rotation.y += deltaX * speed;
        rotation.x -= deltaY * speed;

        if (rotation.x > 89) rotation.x = 89;
        if (rotation.x < -89) rotation.x = -89;

        setTransform();

        previous.x = clientX;
        previous.y = clientY;
      }

      function onPointerUp() {
        isDragging = false;
        cube.classList.remove("dragging");
      }

      cube.addEventListener("mousedown", onPointerDown);
      window.addEventListener("mousemove", onPointerMove);
      window.addEventListener("mouseup", onPointerUp);

      cube.addEventListener("touchstart", function (e) {
        e.preventDefault();
        onPointerDown(e.touches[0]);
      }, { passive: false });

      window.addEventListener("touchmove", function (e) {
        if (!isDragging) return;
        e.preventDefault();
        onPointerMove(e.touches[0]);
      }, { passive: false });

      window.addEventListener("touchend", onPointerUp);

      setTransform();
    })();
  </script>
</body>
</html>
